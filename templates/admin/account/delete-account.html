{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="{% static 'images/favicon-32x32.png' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

    <title>Account Removal</title>
</head>
<body>
   <div class="privacy-container">
    <div class="policy-header">
    <img src="/static/admin/img/logo.png" alt="logo">
    </div>
        <div class="content">
            <h4>Do you want to delete your account?</h4>
            <!-- <p>If you confirm you will be automatically log out and not able to access your account anymore. You will also be unsubscribed from any future emails and correspondance from us. You will receive a confirmation of your account deletion at your email.</p> -->
            <p>We would like to inform you that upon confirming your request, your account will be permanently deleted, and you will no longer be able to access it. Additionally, you will be unsubscribed from any future emails and correspondence from us. Rest assured, you will receive a confirmation email regarding the deletion of your account.</p>

                <p>If you have any concerns or questions, please don't hesitate to reach out to our support team.</p>
            <h5 class="confirm-title">To confirm, please type email in the below box.</h5>


            {% if valid_email %}
                <!-- Bootstrap modal for success case -->
                <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="successModalLabel">Send Request</h5>
                                <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">Ã—</span></button>
                            </div>
                            <div class="modal-body">
                                <p>We're received your request to delete your account. To complete your deletion please check your email and confirm the deletion request.</p>
                                <p>Your account will not be deleted until we receive your confirmation.</p>
                            </div>
                            <div class="modal-bottom">
                                <button class="violet-btn " data-dismiss="modal" aria-label="Close">CLOSE</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- JavaScript code to show the success modal -->
                <script>
                    $(document).ready(function() {
                        $('#successModal').modal('show');
                    });
                </script>
            {% endif %}



            <form method="post" style="width: 100%;" id="emailForm">
            <div class="account_form">
                <div class="account_form_inner">
                        {% csrf_token %}
                        <input type="email" name="user-email" id="user-email" placeholder="Type here" class="email_checkvalid account-email">
                        <button type="submit" class="violet-btn" disabled id="submit-button">Send Request</button>
                    </div>
                </div>
                <span class="error_validation" style="display: none;"></span>
            </div>
        </form>
        </div>
        <!-- You agree that there is no way to reverse this decision -->
        

<style>
    *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: sans-serif;
    }
    .privacy-container{
        max-width: 1280px;
        padding: 0 20px;
        margin: 0 auto;
    }
    .content{
        margin: 50px 0;
    }
    .content h3{
        font-size: 28px;
        line-height: 32px;
        margin-bottom: 20px;
    }
    .content h4{
        font-size: 22px;
        line-height: 32px;
        margin-bottom: 20px;
    }
    .content p{
        font-size: 15px;
        line-height: 1.5;
        font-weight: 400;
        margin-bottom: 16px;
        color: #495057;
    }
     .content ul{
        padding-left: 20px;
    }
    .content ul li{
        font-size: 15px;
        line-height: 1.5;
        font-weight: 400;
        color: #495057;
    }
    .policy-header{
        display: flex;
        align-items: center;
        justify-content: center;
        border-top: solid 20px #4A8BD9;
        border-bottom: solid 20px #B479E4;
    }
    .policy-header img{
        width: 150px;
        margin: 10px 0;
    }
    .account_form{
        width: 50%;
        display: flex;
        margin-top: 10px;
        flex-direction: column;
    }
    .account_form_inner{
        flex-grow: 1;
        display: flex;  
        margin:0 -5px
    }
    .account_form_inner > *{
       margin:0 5px
    }
    .account_form_inner .account-email{
       flex-grow: 1;
        height: 35px;
        padding: 8px 15px;
        border-radius: 0.3rem;
        border: 1px solid #cccccc;
        outline: none;
        font-size: 14px;
    }
    .account_form_inner .account-email:focus-visible{
        border: 1px solid #4A469E;
    }
    .violet-btn{
        background-color:#4A469E;
        border: 1px solid #4A469E;
        color: #ffffff;
        padding: 8px 15px;
        border-radius: 0.3rem;
        height: 35px;
        cursor: pointer;
        font-size: 12px;
        text-transform: uppercase;
        transition: all .2s ease-in;
        outline: none;
    }
    .violet-btn:hover{
        background-color:#605db5;
        border: 1px solid #605db5;
        
    }
    .confirm-title{
        font-size: 16px;
        font-weight: 600;
        color: #6e7079;
    }
    button:disabled {
    cursor: not-allowed; /* Change the cursor style to indicate it's not clickable */
    }
    .error_validation{
        color: red;
        font-size: 14px ;
        display: inline-block;
        margin-top: 5px;
    }
    .modal-header .btn-close{
        position: absolute;
        border: 0;
        background: none;
        font-size: 29px;
        outline: none;
        right: 10px;
        top:0;
    }
    .modal-header{
        position: relative;
    }
    .modal-content{
        padding-bottom: 20px;
    }
    .modal-bottom{
        display: flex;
        justify-content: center;
    }
    .modal-bottom .modal-close-btn{
        padding: ;
    }
       
    @media only screen and (max-width: 820px){
        .account_form{
            width: 100%;
        }
    }
    @media only screen and (max-width: 400px){
        .account_form_inner{
            flex-direction: column;
        }
        .account_form_inner > :last-child{
            margin-top: 15px ;
        }
    }

</style>
    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success' %}
                <script> 
                Swal.fire({
                type: 'success',
                icon: 'success',
                showConfirmButton: false,
                text:'{{message}}'
                });
                </script>
            {% else %}
                <script> 
                $('.error_validation').html("Email is not registered.")
                $('.error_validation').css('display', 'block');
                setTimeout(function() {
                    $('.error_validation').hide();
                }, 60000); // 1 minute = 60,000 milliseconds
                </script>
            {% endif %}
        {% endfor %}
    {% endif %}
    <script>
        // JavaScript
        const emailInput = document.getElementById('user-email');
        const submitButton = document.getElementById('submit-button');

        emailInput.addEventListener('input', function() {
            if (emailInput.value.trim() !== '') {
                submitButton.disabled = false;
                submitButton.style.cursor = 'pointer';
            } else {
                submitButton.disabled = true;
                submitButton.style.cursor = 'not-allowed';
            }
        });
         // Function to validate the email
        // function validateEmail(email) {
        //     $.ajax({
        //     url: '/sec-access/email-checkvalid/',
        //     type: 'POST',
        //     headers: { 'X-CSRFToken': $('[name=csrfmiddlewaretoken]').val() },
        //     async: true,
        //     cache: false,
        //     data: {
        //         'email':email
        //     },
        //     success: function (response) {
        //         resolve(response.valid);
        //     },
        //     error: function () {
        //         reject();
        //     }
        //     })
        // }

        // Handle form submission
        // document.getElementById("emailForm").addEventListener("submit", function(event) {
        // event.preventDefault();
        // const emailInput = document.getElementById("user-email");
        // const email = emailInput.value.trim();

        // try {
        //     const isValidEmail = validateEmail(email);
        //     if (isValidEmail) {
        //     // Email is valid, show the modal
        //     $('#myModal').modal('show');
        //     } else {
        //     // Email is not valid, show error message
        //     alert("Invalid email address!");
        //     }
        // } catch (error) {
        //     console.log('Error occurred during email validation:', error);
        //     // Handle error case if AJAX request fails
        // }
        // });
    </script>
</div></body>
</html>